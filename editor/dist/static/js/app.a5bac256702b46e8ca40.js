webpackJsonp([1],{"5vh9":function(e,t){},"98YR":function(e,t){},DHjG:function(e,t){},Dz4T:function(e,t){},E3hY:function(e,t){},Fimc:function(e,t){},G1X7:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("7+uW"),o=n("zL8q"),a=n.n(o),r=(n("tvR6"),n("Dd8w")),s=n.n(r),l={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("router-link",{attrs:{to:"macro-list"}},[t("i",{staticClass:"fa fa-fire"}),this._v("\n        Macro")]),this._v(" "),t("router-link",{attrs:{to:"layout"}},[t("i",{staticClass:"fa fa-keyboard"}),this._v("\n        Layout")]),this._v(" "),t("router-link",{attrs:{to:"import"}},[t("i",{staticClass:"fa fa-upload"}),this._v("\n        Import")]),this._v(" "),t("router-link",{attrs:{to:"export"}},[t("i",{staticClass:"fa fa-download"}),this._v("\n        Export")])],1)},staticRenderFns:[]};var c=n("VU/8")({},l,!1,function(e){n("nHjd")},"data-v-a77d94b2",null).exports,u=n("NYxO"),d={name:"App",data:function(){return{value:""}},components:{tabs:c},computed:s()({},Object(u.c)(["script"])),methods:{exportConfig:function(){}}},f={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("tabs"),this._v(" "),t("router-view")],1)},staticRenderFns:[]};var m=n("VU/8")(d,f,!1,function(e){n("DHjG")},null,null).exports,p=n("/ocq"),h=n("DAYN"),y=n.n(h),g=n("pFYg"),v=n.n(g),_=n("mvHQ"),k=n.n(_),b={"^":"Control","!":"Alt","+":"Shift","#":"Meta"},x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0],w=[0,0,0,0,0,0,0,0,0,0,0,0,0,40,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,44,30,52,32,33,34,36,52,38,39,37,46,54,45,55,56,39,30,31,32,33,34,35,36,37,38,51,51,54,46,55,56,31,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,47,49,48,45,0,53,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,47,49,48,53,0],C=w.reduce(function(e,t,n){return t&&(e[n]=t),e},{}),S=w.reduce(function(e,t,n){return t&&!x[n]&&/\S/.test(String.fromCharCode(n))&&(e[n]=t),e},{}),M={};w.forEach(function(e,t){x[t]||(M[e]=t)});var R={ControlLeft:"<^",ControlRight:">^",Control:"^",AltLeft:"<!",AltRight:">!",Alt:"!",ShiftLeft:"<+",ShiftRight:">+",Shift:"+",MetaLeft:"<#",MetaRight:">#",Meta:"#"},L={"^":17,"+":34,"!":68,"#":136,"<^":1,"<+":2,"<!":4,"<#":8,">^":16,">+":32,">!":64,">#":128},A={VolumeDown:234,VolumeUp:233,Mute:226,BrightDown:112,BrightUp:111},E={ControlLeft:1,ControlRight:16,Control:17,AltLeft:4,AltRight:64,Alt:68,ShiftLeft:2,ShiftRight:32,Shift:34,MetaLeft:8,MetaRight:128,Meta:136},K={ControlLeft:224,ControlRight:228,AltLeft:226,AltRight:230,ShiftLeft:225,ShiftRight:229,MetaLeft:227,MetaRight:231},$={leftbracket:"{",rightbracket:"}"};var D={ControlLeft:"LControl",ControlRight:"RControl",AltLeft:"LAlt",AltRight:"RAlt",ShiftLeft:"LShift",ShiftRight:"RShift",MetaLeft:"LWin",MetaRight:"RWin"},F={Enter:40,Escape:41,Backspace:42,Tab:43,Space:44,CapsLock:57,F1:58,F2:59,F3:60,F4:61,F5:62,F6:63,F7:64,F8:65,F9:66,F10:67,F11:68,F12:69,PrintScreen:70,ScrollLock:71,Pause:72,Insert:73,Home:74,PageUp:75,Delete:76,End:77,PageDown:78,ArrowRight:79,ArrowLeft:80,ArrowDown:81,ArrowUp:82,NumLock:83},P={customized1:141,customized2:142,customized3:143,customized4:144,customized5:145,customized6:146,customized7:147,customized8:148,customized9:149,customized10:150},U={VolumeUp:"fa fa-volume-up",VolumeDown:"fa fa-volume-down",Mute:"fa fa-volume-off",BrightDown:"fa fa-thermometer-quarter",BrightUp:"fa fa-thermometer-full"},T={Escape:"Esc",";":":\n;","'":"\"\n'",",":"<\n,",".":">\n.","/":"?\n/","]":"}\n]","[":"{\n[","\\":"|\n\\",1:"!\n1",2:"@\n2",3:"#\n3",4:"$\n4",5:"%\n5",6:"^\n6",7:"&\n7",8:"*\n8",9:"(\n9",0:")\n0","-":"_\n-","=":"+\n=","`":"~\n`",ShiftLeft:"LShift",ShiftRight:"RShift",MetaLeft:"LMeta",MetaRight:"RMeta",ControlLeft:"LCtrl",ControlRight:"RCtrl",AltLeft:"LAlt",AltRight:"RAlt",ArrowUp:"↑",ArrowDown:"↓",ArrowRight:"→",ArrowLeft:"←",PrintScreen:"PrtScn"};function z(e){return/^mode\d+$/.test(e)}function j(e){try{return 1*e.match(/(\d+)$/)[1]}catch(e){return null}}function B(e,t){var n,i;return"object"===(void 0===t?"undefined":v()(t))&&t?(n=t,i=k()(n).replace(/"(\w+)":/gm,function(e,t){return t.match(/^\d+$/)?"["+t+"]=":'["'+t+'"]='}),Array.isArray(n)&&(i=i.replace(/^\[/,"{").replace(/\]$/,"}")),t=i):"string"==typeof t&&(t="[["+t+"]]"),"local "+e+"="+t+";"}function I(e){return JSON.parse(e.match(/--\[\[([\s\S]+?)\]\]--/)[1])}var V={name:"Expression",props:["expression","editable"],mounted:function(){},methods:{deleteSection:function(e){this.expression.data.splice(e,1)},upperCaseFirst:function(e){return e.replace(/^[\s\S]/,function(e){return e.toUpperCase()})},isConsumer:function(e){return A[e]},getModifierText:function(e){return e.map(function(e){var t="";return"<"===e[0]?t+="L":">"===e[0]?t+="R":t+=b[e[0]],e[1]&&(t+=b[e[1]]),t}).join("+")}},data:function(){return{}},components:{draggable:y.a}},O={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("draggable",{staticClass:"root",attrs:{options:{animation:250,disabled:!e.editable}},model:{value:e.expression.data,callback:function(t){e.$set(e.expression,"data",t)},expression:"expression.data"}},e._l(e.expression.data,function(t,i){return n("section",{key:i},["print"===t.mode?n("span",{staticClass:"print-section",attrs:{title:"print "+t.value}},[e._v("\n            "+e._s(t.value)+"\n        ")]):e._e(),e._v(" "),"press-key"===t.mode?n("span",{staticClass:"press-key-section el-button--primary",attrs:{title:"Press "+e.upperCaseFirst(t.value)+" Key"}},[e.isConsumer(t.value)?e._e():n("i",{staticClass:"fa fa-gavel",attrs:{"aria-hidden":"true"}}),e._v(" "),e.isConsumer(t.value)?n("i",{staticClass:"fa fa-headphones",attrs:{"aria-hidden":"true"}}):e._e(),e._v("\n            "+e._s(e.upperCaseFirst(t.value))+"\n        ")]):e._e(),e._v(" "),"press-toggle"===t.mode?n("span",{staticClass:"press-toggle-section",attrs:{title:e.getModifierText(t.value.modifiers)+" "+t.value.action}},["down"===t.value.action?n("i",{staticClass:"fa fa-hand-point-down",attrs:{"aria-hidden":"true"}}):e._e(),e._v(" "),"up"===t.value.action?n("i",{staticClass:"fa fa-hand-point-up",attrs:{"aria-hidden":"true"}}):e._e(),e._v("\n            "+e._s(e.getModifierText(t.value.modifiers))+"\n        ")]):e._e(),e._v(" "),e.editable?n("i",{staticClass:"fa fa-minus-circle delete-btn clickable",on:{click:function(t){e.deleteSection(i)}}}):e._e()])}))},staticRenderFns:[]};var N=n("VU/8")(V,O,!1,function(e){n("Dz4T")},"data-v-99b6902e",null).exports,H=n("Gu7T"),J=n.n(H),W=n("lHA8"),Y=n.n(W),G=n("woOf"),Z=n.n(G),q=n("Zrlr"),Q=n.n(q),X=n("wxAW"),ee=n.n(X),te=function(){function e(t){Q()(this,e),"string"==typeof t?this.data=e.matchSubPattern(t,e.expressionReg):Array.isArray(t)&&(this.data=t)}return ee()(e,[{key:"addPrint",value:function(e){var t=this.data&&this.data[this.data.length-1];t&&"print"===t.mode?t.value+=e:this.data.push({mode:"print",value:e})}},{key:"addModifier",value:function(e,t){console.log(e,t);var n={mode:"press-toggle",value:{modifiers:[R[e].split("")],action:t}};this.data.push(n)}},{key:"addPress",value:function(e){" "===e&&(e="Space"),this.data.push({mode:"press-key",value:e})}},{key:"empty",value:function(){this.data=[]}},{key:"toJSON",value:function(){return this.toString()}},{key:"toPlainText",value:function(){var e=0;return this.data.map(function(t){switch(t.mode){case"press-key":var n=void 0;return F[t.value]?n=F[t.value]:A[t.value]&&(n="M"+A[t.value]),n||console.warn("unknown key"),0===e?""+n:e+","+n;case"print":return t.value.split("").map(function(t){var n=x[t.charCodeAt(0)],i=C[t.charCodeAt(0)];return n?L["<+"]+","+i:0===e?""+i:e+","+i}).join(" ");case"press-toggle":var i=t.value.modifiers.reduce(function(e,t){return t=t.join(""),e|L[t]},0);return"down"===t.value.action?e|=i:e&=~i,e+",0";default:return console.warn("unknown mode",t.mode),""}}).join(" ")}},{key:"toString",value:function(){return this.data.map(function(e){switch(e.mode){case"press-key":return"{"+e.value+"}";case"print":return e.value.replace(/[{}]/g,function(e){return"{"===e?"{leftbracket}":"}"===e?"{rightbracket}":""});case"press-toggle":return"{"+e.value.modifiers.map(function(e){return e.join("")}).join("")+"-"+e.value.action+"}";default:return console.warn("unknown mode",e.mode),""}}).join("")}}],[{key:"matchSubPattern",value:function(e,t){var n=[],i=0;e=e.trim();for(var o=function(){var o=e.substr(i);if(!t.some(function(e){var t=e.reg,a=e.mode,r=o.match(t);if(r){var s=!1,l=n[n.length-1];if("print"===a)l&&"print"===l.mode&&(l.value+=r[0],s=!0);else if("press-key"===a){var c=$[r[1]];c&&(s=!0,l&&"print"===l.mode?l.value+=c:n.push({value:r[0],mode:"print"}))}if(!s)if("print"===a)n.push({value:r[0],mode:a});else if("press-key"===a)n.push({value:r[1],mode:a});else if("press-toggle"===a){var u=function(e,t){for(var n=[],i=void 0;i=t.exec(e);)n.push(i.slice(1));return n}(r[1],/([<>]?)([\^+!#])/g),d=r[2];n.push({value:{modifiers:u,action:d},mode:a})}return i+=r[0].length,!0}return!1}))return console.warn("invalid expression",e,i),"break"};i!==e.length;){if("break"===o())break}return n}}]),e}();te.expressionReg=[{reg:/^[^{}]+/,mode:"print"},{reg:/^{([A-Za-z]+)}/,mode:"press-key"},{reg:/^{([^-]+)-([\da-zA-Z]+)}/,mode:"press-toggle"}];var ne=te;function ie(e){var t="";return"<"===e[0]?t="Left":">"===e[0]&&(t="Right"),t=b[e[e.length-1]]+t}var oe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{modifiers:[],expression:new ne("")},n=t.modifiers,i=t.key,o=t.expression;Q()(this,e),"string"==typeof o&&(o=new ne(o)),Z()(this,{modifiers:n,key:i,expression:o})}return ee()(e,[{key:"getModifersUSB",value:function(){return this.modifiers.reduce(function(e,t){return e|E[t]},0)}},{key:"getKeyUSB",value:function(){return e.key2usb(this.key)}}],[{key:"fromFormat0",value:function(t){var n=t.match(e.format0Reg);return new e({modifiers:(n[1].match(/[<>]?[\^+!#]/g)||[]).map(ie),key:1===n[2].length?n[2].toUpperCase():n[2],expression:new ne(n[3])})}},{key:"key2usb",value:function(e){var t=void 0;if(1===(e+="").length){var n=e.charCodeAt(0);t=C[n]}else if(e.match(/^\d+$/))t=1*e;else{if(K[e])return K[e];if(P[e])return P[e];t=F[e]}return t}}]),e}();oe.format0Reg=/([\^+!#<>]*)([\da-zA-Z]+)::([\s\S]+)/;var ae=oe,re={created:function(){this.cachedData=JSON.parse(k()(this.value)),console.log("this.cachedData",this.cachedData),Z()(this.data,this.cachedData),this.data.expression=new ne(this.data.expression),console.log("mounted",this.data)},methods:{onClearExpression:function(){this.data.expression.empty()},onClear:function(){this.data.expression=new ne([]),this.data.modifiers=[],this.data.key=void 0},keyChange:function(e){this.data.expression.addPress(e),this.selectedKey=void 0},consumerChange:function(e){this.data.expression.addPress(e),this.selectedConsumer=void 0},visibleChange:function(e){this.acceptingModifer=e},onKeyDown:function(e){if(this.acceptingModifer){console.log(e,this.data.modifiers);var t=D[e.code];if(console.log("modifier",t),t){var n=new Y.a(this.data.modifiers);n.has(t)?n.delete(t):n.add(t),this.data.modifiers=[].concat(J()(n))}e.preventDefault()}},onInputExpressionUp:function(e){D[e.code]&&(this.blockModifier||this.data.expression.addModifier(e.code,"up"))},onInputExpressionDown:function(e){var t=this;console.log("e",e),console.log(e.key);var n=e.key;n.match(/^[a-zA-Z0-9]$/)||n.match(/^[\S]$/)?this.data.expression.addPrint(n):D[e.code]?this.blockModifier||this.data.expression.addModifier(e.code,"down"):this.data.expression.addPress(n),this.$nextTick(function(){t.expressionInput=""})},onSubmit:function(){this.data.key?ae.key2usb(this.data.key)?this.$emit("input",this.data):alert("unknown key: "+this.data.key):alert("must have a 'key'")}},props:{value:{type:Object}},data:function(){return{selectedKey:void 0,key2usb:F,selectedConsumer:void 0,consumer2usb:A,cachedData:void 0,modifier2ahk:E,acceptingModifer:!1,expressionInput:"",expression:[],data:{modifiers:void 0,key:void 0,expression:void 0},blockModifier:!0}},components:{ExpressionComp:N}},se={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{on:{keydown:e.onKeyDown}},[n("el-form",{ref:"form",attrs:{"label-width":"100px"}},[n("el-form-item",{attrs:{label:"Modifiers"}},[n("el-select",{staticStyle:{width:"400px"},attrs:{multiple:"",placeholder:"Select"},on:{"visible-change":e.visibleChange},model:{value:e.data.modifiers,callback:function(t){e.$set(e.data,"modifiers",t)},expression:"data.modifiers"}},e._l(e.modifier2ahk,function(e,t){return n("el-option",{key:e,attrs:{label:t,value:t}})}))],1),e._v(" "),n("el-form-item",{attrs:{label:"Key"}},[n("el-input",{staticStyle:{width:"220px"},model:{value:e.data.key,callback:function(t){e.$set(e.data,"key",t)},expression:"data.key"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"Expression"}},[n("div",{on:{keydown:function(t){t.preventDefault(),e.onInputExpressionDown(t)},keyup:e.onInputExpressionUp}},[n("el-input",{staticStyle:{width:"150px",color:"white"},attrs:{placeholder:"Focus to input"},model:{value:e.expressionInput,callback:function(t){e.expressionInput=t},expression:"expressionInput"}}),e._v(" "),n("el-checkbox",{model:{value:e.blockModifier,callback:function(t){e.blockModifier=t},expression:"blockModifier"}},[e._v("BlockModifier")]),e._v(" "),n("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"Media"},on:{change:e.consumerChange},model:{value:e.selectedConsumer,callback:function(t){e.selectedConsumer=t},expression:"selectedConsumer"}},e._l(e.consumer2usb,function(e,t){return n("el-option",{key:e,attrs:{label:t,value:t}})})),e._v(" "),n("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"Key"},on:{change:e.keyChange},model:{value:e.selectedKey,callback:function(t){e.selectedKey=t},expression:"selectedKey"}},e._l(e.key2usb,function(e,t){return n("el-option",{key:e,attrs:{label:t,value:t}})}))],1),e._v(" "),n("ExpressionComp",{attrs:{expression:e.data.expression,editable:!0}}),e._v(" "),n("div",[e._v(e._s(e.data.expression.toPlainText()))])],1),e._v(" "),n("el-form-item",{attrs:{label:""}},[n("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("Save")]),e._v(" "),n("el-button",{attrs:{type:"danger"},on:{click:e.onClear}},[e._v("Clear")]),e._v(" "),n("el-button",{attrs:{type:"danger"},on:{click:e.onClearExpression}},[e._v("Clear Expression")])],1)],1)],1)},staticRenderFns:[]};var le=n("VU/8")(re,se,!1,function(e){n("sJI9")},"data-v-2207ea2c",null).exports,ce={methods:{onClick:function(){this.$emit("click")},getShort:function(e){return T[e]||e},isModeTrigger:z,getModeFromModeTrigger:j,isCustomized:function(e){return/^customized\d+$/.test(e)},getIndexFromCustomized:function(e){return j(e)}},data:function(){return{key2icon:U}},computed:{title:function(){return this.text?null:"inherit from basic mode"},shortText:function(){return this.text?this.getShort(this.text):this.getShort(this.basicText)},finalStyle:function(){var e={width:54*this.width+"px"};return this.style0&&this.style0["margin-left"]&&(e["margin-left"]=54*this.style0["margin-left"]+"px"),e}},props:{style0:{type:Object},line:{type:Number,default:1},width:{type:Number,default:1},text:{},basicText:{}}},ue={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"kb-key clickable",class:{inherit:!e.text},style:e.finalStyle,attrs:{title:e.text},on:{click:e.onClick}},[n("div",{staticClass:"key-front flex-center"},[e.key2icon[e.shortText]?n("div",[n("i",{class:e.key2icon[e.shortText]})]):e.isModeTrigger(e.shortText)?n("div",[n("i",{staticClass:"fa fa-code-branch"}),e._v(" "),n("span",[e._v(e._s(e.getModeFromModeTrigger(e.shortText)))])]):e.isCustomized(e.shortText)?n("div",[n("i",{staticClass:"fa fa-wrench"}),e._v(" "),n("span",[e._v(e._s(e.getIndexFromCustomized(e.shortText)))])]):n("div",{staticClass:"text"},[e._v(e._s(e.shortText))])])])},staticRenderFns:[]};var de=n("VU/8")(ce,ue,!1,function(e){n("quV6")},"data-v-457a3cc0",null).exports,fe=Object(u.a)("MacroList"),me=fe.mapState,pe=fe.mapActions,he=fe.mapMutations,ye={name:"MacroList",data:function(){return{output:""}},computed:s()({},me(["list","canUndo","canRedo"])),mounted:function(){var e=this;window.a=function(){console.log(e.list)}},methods:s()({},pe(["undo","redo"]),he(["remove","add","set"]),{connect:function(){var e=void 0;navigator.usb.requestDevice({filters:[{vendorId:1155}]}).then(function(t){return e=t,console.log(e.productName),console.log(e.manufacturerName),window.usbdevice=e,e.open()}).then(function(){return e.claimInterface(2)}).then(function(){return e.transferOut(4,new ArrayBuffer(64))}).then(function(e){var t=new TextDecoder;console.log("Received: "+t.decode(e.data))}).catch(function(e){console.log(e)})},addRule:function(){this.add(new ae)},getIndexOfRow:function(e){return this.list.indexOf(e)},edit:function(e){this.$refs.table.toggleRowExpansion(e)},onSave:function(e,t){this.$refs.table.toggleRowExpansion(e);var n=this.list.indexOf(e);this.set({index:n,data:new ae(t)})},exportConfig:function(){var e,t,n,i={};this.list.forEach(function(e){var t=e.getModifersUSB(),n=e.getKeyUSB();i[n]||(i[n]={}),i[n][t]=e.expression.toPlainText()}),this.$store.commit("setAHK",i),this.output+=this.$store.getters.script,e="main.lua",t=this.$store.getters.script,(n=document.createElement("a")).setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}}),components:{ExpressionComp:N,RuleEditor:le,draggable:y.a,Key:de}},ge={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"comp-macro-list table-wrap window"},[n("header",[n("i",{staticClass:"redo-btn fa fa-undo",class:{active:e.canUndo,clickable:e.canUndo},on:{click:function(t){e.undo()}}}),e._v(" "),n("i",{staticClass:"undo-btn fa fa-redo",class:{active:e.canRedo,clickable:e.canRedo},on:{click:function(t){e.redo()}}})]),e._v(" "),n("el-table",{ref:"table",staticClass:"table",attrs:{data:e.list,stripe:""}},[n("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("RuleEditor",{attrs:{value:t.row},on:{input:function(n){e.onSave(t.row,n)}}})]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"Modifiers",align:"left",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.modifiers,function(t){return n("span",{key:t,staticClass:"modifier"},[e._v("\n                    "+e._s(t)+"\n                ")])})}}])}),e._v(" "),n("el-table-column",{attrs:{label:"Key",width:"80",align:"center",sortable:""},scopedSlots:e._u([{key:"default",fn:function(e){return[n("Key",{attrs:{text:e.row.key,width:1,line:1}})]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"Expression"},scopedSlots:e._u([{key:"default",fn:function(e){return[n("ExpressionComp",{attrs:{expression:e.row.expression,editable:!1}})]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"Action",align:"center",width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{staticClass:"miao-hover"},[n("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(n){e.edit(t.row)}}},[n("i",{staticClass:"fa fa-edit"}),e._v(" Edit")]),e._v(" "),n("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(n){e.remove(e.getIndexOfRow(t.row))}}},[n("i",{staticClass:"fa fa-trash"}),e._v(" Delete")])],1)]}}])})],1),e._v(" "),n("div",[n("el-button",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{type:"primary"},on:{click:e.addRule}},[n("i",{staticClass:"fa fa-plus"}),e._v(" Add")])],1)],1)},staticRenderFns:[]};var ve=n("VU/8")(ye,ge,!1,function(e){n("wNog"),n("5vh9")},"data-v-3718b7fb",null).exports,_e={dbs:{label:"Double Space",name:"dbs",value:{name:"11",layout:[[{},{},{},{},{},{},{},{},{},{},{},{},{},{w:2}],[{w:1.5},{},{},{},{},{},{},{},{},{},{},{},{},{w:1.5}],[{w:1.75},{},{},{},{},{},{},{},{},{},{},{},{w:2.25,l:2}],[{w:2.25,l:2},{},{},{},{},{},{},{},{},{},{},{w:2.75,l:2}],[{w:1.25},{w:1.25},{w:1.25},{w:1.25},{w:1.75,l:2},{w:1.75,l:2},{style:{"margin-left":.25},w:1.25,l:2},{w:1.25},{w:1.25},{w:1.25},{w:1.25}]]}},tex:{label:"Tex Yoda",name:"tex",value:{name:"22",layout:[[{},{},{},{},{},{},{},{},{},{},{},{},{},{w:2}],[{w:1.5},{},{},{},{},{},{},{},{},{},{},{},{},{w:1.5}],[{w:1.75},{},{},{},{},{},{},{},{},{},{},{},{w:2.25,l:2}],[{w:2.25,l:2},{},{},{},{},{},{},{},{},{},{},{w:2.75,l:2}],[{w:1.25},{w:1.25},{w:1.25},{w:3.25,l:4},{w:1},{w:1},{w:1},{w:1.25},{w:1.25},{w:1.25},{w:1.25}]]}}},ke=function(){function e(t){var n=t.index,i=t.isBasic,o=t.macro,a=t.map,r=t.trigger;Q()(this,e),this.macro=o,this.map=a,this.isBasic=i,this.index=n,i?e.basicMode=this:this.trigger=r}return ee()(e,[{key:"toPlainObject",value:function(){var e={isBasic:this.isBasic,macro:this.macro,map:this.map};return this.isBasic||(e.trigger=this.trigger),e}},{key:"setLayout",value:function(e){this.layout=_e[e].value.layout}},{key:"getUSBMap",value:function(){var e=this,t=[];return this.layout.forEach(function(n,i){var o=[];t.push(o),n.forEach(function(t,n){var a=1;t.l&&(a=t.l);for(var r=0;r<a;r++){var s=e.map[i][n],l=ae.key2usb(s);l?o.push(l):o.push(s)}})}),t}}],[{key:"modesGetLua",value:function(e,t){var n=128,i={},o={};var a=e.map(function(e){return e.getUSBMap()}),r=a[0],s=a.reduce(function(e,t){return e+t.reduce(function(e,a,s){return e+a.reduce(function(e,a,l){var c,u,d,f,m,p=a;return"string"==typeof a?(u=n++,z(c=a)?o[u]=j(c)+1:A[c]?i[u]=A[c]:console.warn("unknown key",c),p=u,t[s][l]=p):null===a&&r[s][l]&&(p=r[s][l]),e+(f=3,(m=(d=p).toString()).length>f?d:"0".repeat(f-m.length)+m)+","},"")+"000,000,\n"},"")+"\n"},"");s=s.replace(/\s/g,"");var l=e.map(function(e){return{isBasic:e.isBasic,trigger:e.trigger,macro:e.macro}});t.push(["kb_index",s]),t.push(["consumer_map",i]),t.push(["mode_trigger_map",o]),t.push(["modes_config",l])}}]),e}();ke.basicMode=null;var be=ke,xe={methods:{selectKey:function(e,t){var n=this.layoutarr[e][t];this.selectedKey===n?(this.selectedKey=void 0,this.$emit("unselectKey")):(this.selectedKey=this.layoutarr[e][t],this.$emit("selectKey",e,t))}},mounted:function(){console.log(this.layoutarr)},computed:s()({},Object(u.c)({basicMap:function(e){return e.modes[0].map}}),{layoutarr:function(){return _e[this.layout].value.layout}}),props:["map","layout"],data:function(){return{selectedKey:void 0}},components:{Key:de}},we={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",e._l(e.layoutarr,function(t,i){return n("div",{key:i,staticClass:"kb-line"},e._l(t,function(t,o){return n("Key",{key:o,class:{selected:t===e.selectedKey},attrs:{text:e.map[i][o],basicText:e.basicMap[i][o],width:t.w,line:t.l,style0:t.style},on:{click:function(t){e.selectKey(i,o)}}})}))}))},staticRenderFns:[]};var Ce=n("VU/8")(xe,we,!1,function(e){n("G1X7")},"data-v-16a4decc",null).exports,Se={methods:{onClear:function(){this.$emit("input",null)},keyChange:function(){var e=this.selectedKey||this.selectedConsumer||this.selectedModifier||this.selectedModeTrigger||this.selectedChar||this.selectedCustomized;console.log("change",e),this.$emit("input",e),this.selectedKey=null,this.selectedConsumer=null,this.selectedModifier=null,this.selectedChar=null,this.selectedModeTrigger=null,this.selectedCustomized=null},onKeyDown:function(e){console.log("e",e),console.log(e.key);var t=e.key;t.match(/^[a-zA-Z0-9]$/)||t.match(/^[\S]$/)?x[e.key.charCodeAt(0)]?this.$emit("input",null):this.$emit("input",t.toUpperCase()):" "===t?this.$emit("input","Space"):D[e.code]?this.$emit("input",e.code):this.$emit("input",e.key)}},watch:{},mounted:function(){},props:["keyText","value","baseValue"],computed:s()({},Object(u.c)(["modes"])),data:function(){return{key2usb:F,selectedKey:null,selectedConsumer:null,selectedModifier:null,modifier2usb:K,consumer2usb:A,baseAscii2usb:S,selectedChar:null,selectedModeTrigger:null,selectedCustomized:null,customized2usb:P}},components:{}},Me={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"wrap",on:{keydown:function(t){t.preventDefault(),e.onKeyDown(t)}}},[n("el-form",{ref:"form",attrs:{"label-width":"80px"}},[n("el-form-item",{attrs:{label:"Key name"}},[n("el-input",{attrs:{value:e.value,placeholder:"inherit: "+e.baseValue,clearable:""},on:{clear:e.onClear}})],1),e._v(" "),n("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"Key"},on:{change:e.keyChange},model:{value:e.selectedKey,callback:function(t){e.selectedKey=t},expression:"selectedKey"}},e._l(e.key2usb,function(e,t){return n("el-option",{key:e,attrs:{label:t,value:t}})})),e._v(" "),n("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"Media"},on:{change:e.keyChange},model:{value:e.selectedConsumer,callback:function(t){e.selectedConsumer=t},expression:"selectedConsumer"}},e._l(e.consumer2usb,function(e,t){return n("el-option",{key:e,attrs:{value:t}})})),e._v(" "),n("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"Modifier"},on:{change:e.keyChange},model:{value:e.selectedModifier,callback:function(t){e.selectedModifier=t},expression:"selectedModifier"}},e._l(e.modifier2usb,function(e,t){return n("el-option",{key:e,attrs:{value:t}})})),e._v(" "),n("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"Char"},on:{change:e.keyChange},model:{value:e.selectedChar,callback:function(t){e.selectedChar=t},expression:"selectedChar"}},e._l(e.baseAscii2usb,function(e,t){return n("el-option",{key:t,attrs:{value:String.fromCharCode(t).toUpperCase()}})})),e._v(" "),n("el-select",{staticStyle:{width:"140px"},attrs:{placeholder:"Mode trigger"},on:{change:e.keyChange},model:{value:e.selectedModeTrigger,callback:function(t){e.selectedModeTrigger=t},expression:"selectedModeTrigger"}},e._l(e.modes,function(t,i){return t.isBasic?e._e():n("el-option",{key:i,attrs:{value:"mode"+i}})})),e._v(" "),n("el-select",{staticStyle:{width:"140px"},attrs:{placeholder:"Customized"},on:{change:e.keyChange},model:{value:e.selectedCustomized,callback:function(t){e.selectedCustomized=t},expression:"selectedCustomized"}},e._l(e.customized2usb,function(e,t){return n("el-option",{key:t,attrs:{value:t}})}))],1)],1)},staticRenderFns:[]};var Re=n("VU/8")(Se,Me,!1,function(e){n("E3hY")},"data-v-2375e2c1",null).exports,Le={methods:{getModeFromModeTrigger:j},mounted:function(){},props:["mode"],computed:{isBasicMode:function(){return"basic"===this.mode.name}},data:function(){return{}},components:{}},Ae={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"wrap"},[e.mode?n("el-form",{ref:"form",staticStyle:{"margin-left":"20px"},attrs:{model:e.mode}},[e.mode.isBasic?n("el-form-item",{attrs:{label:"Basic Mode",title:"mode0 is always basic mode"}},[n("el-switch",{attrs:{value:!0,disabled:""}})],1):e._e(),e._v(" "),n("el-form-item",{attrs:{label:"Enable macro"}},[n("el-switch",{model:{value:e.mode.macro,callback:function(t){e.$set(e.mode,"macro",t)},expression:"mode.macro"}})],1),e._v(" "),e.mode.isBasic?e._e():n("el-container",[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"Trigger"}},[n("el-select",{attrs:{placeholder:"please select your zone"},model:{value:e.mode.trigger,callback:function(t){e.$set(e.mode,"trigger",t)},expression:"mode.trigger"}},[n("el-option",{attrs:{label:"Keep pressing to tigger",value:"pressing"}}),e._v(" "),n("el-option",{attrs:{label:"Press to trigger",value:"toggle"}})],1)],1)],1),e._v(" "),n("el-col",{attrs:{span:11}},[n("el-form-item",{attrs:{label:"Trigger key"}},[n("i",{staticClass:"fa fa-code-branch"}),e._v(" "),n("span",[e._v(e._s(e.mode.index))])])],1)],1)],1):e._e(),e._v(" "),e.mode?e._e():n("div",{staticStyle:{flex:"1"}},[e._v("\n        Select a mode first\n    ")])],1)},staticRenderFns:[]};var Ee=n("VU/8")(Le,Ae,!1,function(e){n("Fimc")},"data-v-0a3cbcee",null).exports;console.log("kbLayouts",_e);var Ke={methods:{selectKey:function(e,t){this.selectedKey={x:e,y:t}},unselectKey:function(){this.selectedKey=null},setLayout:function(e){this.$store.commit("setLayout",e)}},created:function(){},computed:s()({},Object(u.c)({modes:function(e){return e.modes},baseMap:function(e){return e.modes[0].map},layout:function(e){return e.layout}})),mounted:function(){this.modes&&(this.selectedMode=this.modes[0])},data:function(){return{kbLayouts:_e,selectedMode:void 0,selectedKey:null}},components:{Keyboard:Ce,ModeEditor:Ee,KeyboardEditor:Re}},$e={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"comp-layout window"},[n("el-select",{attrs:{value:e.layout,placeholder:"Select Layout"},on:{input:e.setLayout}},e._l(e.kbLayouts,function(e,t){return n("el-option",{key:t,attrs:{label:e.label,value:e.name}})})),e._v(" "),e.selectedMode&&e.layout?n("Keyboard",{attrs:{map:e.selectedMode.map,layout:e.layout},on:{unselectKey:e.unselectKey,selectKey:e.selectKey}}):e._e(),e._v(" "),e.selectedKey&&e.selectedMode?n("KeyboardEditor",{attrs:{baseValue:e.baseMap[e.selectedKey.x][e.selectedKey.y]},model:{value:e.selectedMode.map[e.selectedKey.x][e.selectedKey.y],callback:function(t){e.$set(e.selectedMode.map[e.selectedKey.x],e.selectedKey.y,t)},expression:"selectedMode.map[selectedKey.x][selectedKey.y]"}}):e._e(),e._v(" "),n("div",{staticClass:"mode-wrap"},[n("div",{staticClass:"mode-select"},e._l(e.modes,function(t,i){return n("div",{key:i,staticClass:"mode clickable",class:{selected:e.selectedMode==t},on:{click:function(n){e.selectedMode=t}}},[e._v(e._s(t.name||"mode"+i))])})),e._v(" "),n("div",{staticClass:"mode-editor"},[n("ModeEditor",{attrs:{mode:e.selectedMode}})],1)])],1)},staticRenderFns:[]};var De=n("VU/8")(Ke,$e,!1,function(e){n("s7If")},"data-v-527c98ff",null).exports,Fe=n("vhHo"),Pe=n.n(Fe),Ue={created:function(){},mixins:[{data:function(){return{dragging:!1}},methods:{drop:function(e){this.dragging=!1,e.stopPropagation(),e.preventDefault();var t=Array.prototype.slice.call(e.dataTransfer.items),n=this;t.forEach(function(e){if("file"===e.kind){var t=new FileReader;t.onloadend=function(){n.onDrop&&n.onDrop(this.result)},t.readAsText(e.getAsFile())}})},dragClear:function(){this.dragging=!1},dragEnter:function(e){this.dragging=!0,e.stopPropagation(),e.preventDefault()},dragExit:function(e){e.stopPropagation(),e.preventDefault()},dragLeave:function(e){e.stopPropagation(),e.preventDefault()},dragOver:function(e){e.stopPropagation(),e.preventDefault()}}}],computed:{canImport:function(){try{I(this.config)}catch(e){return!1}return!0}},methods:{name:"Import",onDrop:function(e){this.config=e,this.submit()},submit:function(){var e=void 0;try{e=I(this.config)}catch(e){return void this.$message({message:e.message,type:"error"})}this.$store.commit("importConfig",e),this.$message({message:"Succeed to import config!",type:"success",duration:1300})},importDefault:function(){this.$store.commit("importConfig",Pe.a),this.$message({message:"Succeed to import default config!",type:"success",duration:500})}},mounted:function(){var e=this;setTimeout(function(){e.importDefault()})},data:function(){return{config:""}},components:{}},Te={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"comp-layout window",class:{dragging:e.dragging},on:{drop:e.drop,dragenter:e.dragEnter,dragleave:e.dragLeave,dragexit:e.dragExit,dragover:e.dragOver,mouseover:e.dragClear}},[n("el-form",[n("el-form-item",{attrs:{label:"Config File"}},[n("el-input",{attrs:{type:"textarea"},model:{value:e.config,callback:function(t){e.config=t},expression:"config"}})],1),e._v(" "),n("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.submit}},[e._v("Import")]),e._v(" "),n("el-button",{staticStyle:{width:"100%",margin:"0","margin-top":"20px"},attrs:{type:"warning"},on:{click:e.importDefault}},[e._v("Import Default Config")])],1)],1)},staticRenderFns:[]};var ze=n("VU/8")(Ue,Te,!1,function(e){n("aJJW")},"data-v-c189685a",null).exports,je=n("TQvf"),Be=n.n(je),Ie={name:"Export",mixins:[],mounted:function(){var e=this;this.$store.dispatch("exportConfig"),new Be.a(this.$refs.copy.$el,{text:function(){return e.script}}).on("success",function(){e.$message({message:"Successfully copied",type:"success"})})},computed:s()({},Object(u.c)(["script"])),methods:{download:function(e,t){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}},data:function(){return{config:""}},components:{}},Ve={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"window"},[n("el-input",{staticStyle:{"border-top-left-radius":"0","border-top-right-radius":"0"},attrs:{type:"textarea",value:e.script,readonly:"",rows:15}}),e._v(" "),n("div",{staticStyle:{display:"flex","flex-direction":"row"}},[n("el-button",{ref:"copy",staticStyle:{flex:"1",margin:"0"},attrs:{"data-clipboard-text":e.script,type:"warning"}},[e._v("Copy")]),e._v(" "),n("el-button",{staticStyle:{flex:"1",margin:"0"},attrs:{type:"primary"},on:{click:function(t){e.download("main.lua",e.script)}}},[e._v("Download")])],1)],1)},staticRenderFns:[]};var Oe=n("VU/8")(Ie,Ve,!1,function(e){n("98YR")},"data-v-24ab51a2",null).exports;i.default.use(p.a);var Ne=new p.a({routes:[{path:"/",name:"home",component:ve},{path:"/macro-list",name:"macro-list",component:ve},{path:"/layout",name:"layout",component:De},{path:"/import",name:"import",component:ze},{path:"/export",name:"export",component:Oe}]}),He=n("d7EF"),Je=n.n(He),We=function(){function e(t){var n=this;Q()(this,e);["state","actions","mutations","getters"].forEach(function(e){n[e]={},t[e]&&Z()(n[e],t[e])}),this.namespaced=!0,this.actions.undo=this.undo.bind(this),this.actions.redo=this.redo.bind(this),this.state.canUndo=!1,this.state.canRedo=!1;var i="-undo"+Date.now()+Math.random();e.commands.forEach(function(e){n.mutations[e.name]=function(t,i){var o=e.exec.call(n,t.list,i);n.inRedo||n.stackPosition++,n.setCurrentRecord({commandName:e.name,payload:i,result:o}),n.inRedo||n.history.splice(n.stackPosition),n.canRedo()||(n.state.canRedo=!1),n.state.canUndo=!0},n.mutations[""+e.name+i]=function(t,i){n.data=t.list,e.undo.call(n,t.list,i.payload,i.result),n.stackPosition--,n.canUndo()||(n.state.canUndo=!1),n.state.canRedo=!0}}),this.random=i,this.commands={},this.history=[],this.stackPosition=0,this.inRedo=!1}return ee()(e,[{key:"setCurrentRecord",value:function(e){this.history[this.stackPosition-1]=e}},{key:"getCurrentRecord",value:function(){return this.history[this.stackPosition-1]}},{key:"undo",value:function(e){if(this.canUndo()){var t=this.getCurrentRecord();e.commit(t.commandName+this.random,{payload:t.payload,result:t.result})}}},{key:"canUndo",value:function(){return this.stackPosition>0}},{key:"redo",value:function(e){if(this.canRedo()){this.inRedo=!0,this.stackPosition++;var t=this.getCurrentRecord();e.commit(t.commandName,t.payload),this.inRedo=!1}}},{key:"canRedo",value:function(){return this.stackPosition<this.history.length}}]),e}();We.commands=[{name:"remove",exec:function(e,t){return e.splice(t,1)},undo:function(e,t,n){e.splice.apply(e,[t,0].concat(J()(n)))}},{name:"set",exec:function(e,t){var n=t.index,i=t.data;return e.splice(n,1,i)},undo:function(e,t,n){var i=t.index;e.splice.apply(e,[i,1].concat(J()(n)))}},{name:"add",exec:function(e,t){e.push(t)},undo:function(e){e.pop()}}];var Ye=new We({state:{list:[]},mutations:{setList:function(e,t){e.list=t}},actions:{},getters:{}});i.default.use(u.b);var Ge=[],Ze=n("QNIj");var qe=new u.b.Store({state:{ahk:{},modes:Ge,script:"",layout:""},mutations:{importConfig:function(e,t){t.modes.forEach(function(e,t){e.index=t}),console.log(t,e),e.modes=t.modes.map(function(e){return new be(e)}),e.MacroList.list=t.macro.map(function(e){return new ae(e)}),t.layout||(t.layout="dbs"),e.layout=t.layout,e.modes.forEach(function(e){e.setLayout(t.layout)})},setLayout:function(e,t){e.layout=t,e.modes.forEach(function(e){e.setLayout(t)})},setAHK:function(e,t){e.ahk=t},setScript:function(e,t){e.script=t}},actions:{exportConfig:function(e){var t=e.commit,n=e.state,i="",o={};n.MacroList.list.forEach(function(e){var t=e.getModifersUSB(),n=e.getKeyUSB();o[n]||(o[n]={}),o[n][t]=e.expression.toPlainText()}),window.modes=Ge;var a=[];be.modesGetLua(this.state.modes,a),a.push(["ahk_data",o]),i=function(e){var t={};return t.modes=e.modes.map(function(e){return e.toPlainObject()}),t.macro=e.MacroList.list,t.layout=e.layout,console.log(e.MacroList.list),"--[[\n        "+k()(t,!1,4)+"\n    ]]--\n    "}(n),i+=a.map(function(e){var t=Je()(e,2);return B(t[0],t[1])}).join("\n"),console.log("ret:",i),t("setScript",i+=Ze)}},getters:{},modules:{MacroList:Ye}});n("tERj"),i.default.use(a.a),i.default.config.productionTip=!1,new i.default({el:"#app",router:Ne,store:qe,components:{App:m},template:"<App/>"})},QNIj:function(e,t){e.exports='-- Don\'t use chinese comment.\n-- ahk\'s map ahk_data[normal_key][modifier_key]\n\n\n-- injected: kb_index,consumer_map,\n-- init_datasheet(file_name, data_width): lua parse the table file,return a table for lua\n-- shift_table: (user shouldn\'t modify it) which key needs to be output with a shift key \n-- key_index: (most user may modify it) record 3 modes\' usb value in a key map\n-- asciiusb: (user shouldn\'t modify it) ascii value to usb value\nlocal key_index_data=init_datasheet(kb_index,3,1,string.len(kb_index)); \n--kb_index=nil;\n-- init_datasheet("config/ascii2usb.txt",3);\n\n-- count of rows and column in the "key_index.txt" file\nlocal rows=5;\nlocal columns=16;\n\n\n-- functions that can be invoked in ahk file\nlocal ahk_avaliable_function={\n    restart= function() clear_key();delay(100);restart_keyboard(); end,\n}\n\n-- mode2 and mode3\'s value in key_index.txt file\n\n-- wait for user releasing all the key, do nothing before releasing\nlocal wait_release=false;\n\n-- currently using key map\nlocal key_map_mode=1;\n\n-- use to solve linux capslock delay bug\nlocal capslockCode=57;\nlocal clear_key,single_key,get_bit,modifier_compare,output_ahk,media_output,media_output,modifiers2value,set_key_map_mode,key_input_underlying;\n\n\nfunction get_key_from_position(pos,index)\n    if not index then\n        index=key_map_mode;\n    end\n\n    local num=read_datasheet(key_index_data,pos+(index-1)*columns*rows);\n    if index~=1 and num==0 then\n        return get_key_from_position(pos,1);\n    else\n        return num;\n    end    \nend\n\n-- extend original string class, now we can use brackets to get a sub string from a string like: a[2]\ngetmetatable(\'\').__index = function(str,i) return string.sub(str,i,i) end\ngetmetatable(\'\').__call = function(str,i,j)\n    if type(i)~=\'table\' then return string.sub(str,i,j)\n    else local t={}\n        for k,v in ipairs(i) do t[k]=string.sub(str,v,v) end\n        return table.concat(t)\n    end\nend\n\nget_bit= function (num,index) \n    return bit32.band(num,bit32.lshift(1,index))>0;    \nend\n\n-- if the modifier keys satisfy the target one\nmodifier_compare= function (modifier,target)\n    for i=0,3 do\n        local tleft=get_bit(target,i);\n        local nleft=get_bit(modifier,i);\n        local tright=get_bit(target,i+4);        \n        local nright=get_bit(modifier,i+4);\n        local both=false;\n        if tleft and tright then\n            both=true;\n        end\n        if both then\n            if not (nright or nleft) then\n            return false\n            end\n        else\n            if tleft and not nleft then\n                return false\n            end\n            if tright and not nright then\n                return false\n            end\n        end \n        if (nleft or nright) and not (tright or tleft) then\n            return false;\n        end\n    end\n    return true;\nend\n\nset_key_map_mode=function(mode,led)\n    key_map_mode=mode;\n    if mode~=1 and led then\n        led_clear();\n        led_set_mode(0);\n\n        for i=0,13 do\n            for j=0,4 do\n                if get_key_from_position(j*16+i,mode)~=get_key_from_position(j*16+i,1) then\n                    led_set_bit(i,j,1);\n                end\n            end\n        end\n    else        \n        led_clear();\n        led_set_mode(1);\n    end\nend\nset_key_map_mode(1,true);\n\nlocal previous_cnt=0;\nlocal previous_key_map_mode=1;\nlocal previous_capslock=false;\n\nlocal pressed_media=false;\nlocal withModifierPattern="^(%d+),(%d+)$";\nlocal keyPattern="^(%d+)$";\nlocal mediaPattern="^M(%d+)$";\noutput_ahk= function (expression)\n    clear_key();\n    local modifier_this_turn=0;\n    local first=true;\n    for section in string.gmatch(expression,"[^ ]+") do \n        if not first then\n            single_key(modifier_this_turn,0);\n            delay(15);\n        end\n        if string.match(section,withModifierPattern) then\n            local modifier,key = string.match(section,withModifierPattern);\n            single_key(tonumber(modifier),tonumber(key));            \n            modifier_this_turn=modifier;\n        elseif string.match(section,keyPattern) then           \n            local key=string.match(section,keyPattern);\n            single_key(0,tonumber(key));\n        elseif string.match(section,mediaPattern) then           \n            local key=string.match(section,mediaPattern);\n            media_output(tonumber(key));\n            pressed_media=true;\n        end        \n        delay(15);   \n        first=false;      \n    end\nend\n\nfunction clear_key()\n    single_key(0,0);    \nend\n\nsingle_key=function(modifier,key)\n    output(modifier,0,key,0,0,0,0,0)\nend\n\n\n\n\nlocal key_press_pattern="{([^-]+)-([%d%a]+)}";\n\n\n\nmedia_output= function (value)\n    mouse_output(3,value%256,math.floor(value/256),0,0);\nend\n\nlocal pressed_capslock=false;\nkey_input_underlying=function (modifiers,cnt,key_arr)\n    local final_normal_keys={};\n    local enter_key_map_mode=key_map_mode;\n    \n    if key_map_mode~=1 and modes_config[key_map_mode].trigger==\'pressing\' then\n        key_map_mode=1;\n    end\n    -- decide current key_map_mode\n    for i=1,cnt do\n        local value=get_key_from_position(key_arr[i],1);\n\n        if mode_trigger_map[value] then\n            key_arr[i]=nil;\n            local mode=mode_trigger_map[value];\n            local mode_config_target=modes_config[mode];\n            \n            if mode_config_target.trigger=="toggle" then\n                if key_map_mode ~= mode then\n                    key_map_mode=mode;\n                else\n                    key_map_mode=1;\n                end\n            else\n                key_map_mode=mode;\n            end\n        elseif value == capslockCode then\n            pressed_capslock=true;\n            if pressed_capslock and previous_capslock then\n                key_arr[i]=nil;\n            end\n        end        \n    end\n\n    if key_map_mode ~= enter_key_map_mode then\n        set_key_map_mode(key_map_mode,true);\n    end\n\n    local mode_config=modes_config[key_map_mode];\n\n\n    -- handle mode2 race condition\n    if mode_config.trigger ~= "pressing" and modes_config[previous_key_map_mode].trigger=="pressing" then\n        clear_key();\n        return;\n    end\n    \n    -- get final key values \n    local valid_key_cnt=0;\n\n    for i=1,cnt do        \n        if key_arr[i] ~= nil then\n            local value=get_key_from_position(key_arr[i]);\n\n            \n\n            if consumer_map[value] then\n                media_output(consumer_map[value]);\n                pressed_media=true;\n                return ;\n            end\n            final_normal_keys[valid_key_cnt+1]=value;            \n            valid_key_cnt=valid_key_cnt+1;        \n        end                \n    end\n    \n   \n\n    for i=valid_key_cnt,cnt do\n        final_normal_keys[i+1]=0;\n    end\n    \n    if pressed_media then\n        media_output(0);\n        pressed_media=false;\n    end\n    -- wait for releasing all normal keys\n    if cnt==0 then\n        wait_release=false;\n    end\n\n    if mode_config.macro then\n        if previous_cnt < cnt and ahk_data[final_normal_keys[1]] then \n            for target_modifiers,expression in pairs(ahk_data[final_normal_keys[1]]) do\n                if modifier_compare(modifiers,target_modifiers) then\n                    output_ahk(expression);\n                    wait_release=true;\n                    return;\n                end\n                \n            end\n        end\n    end\n\n    if not wait_release then\n        output(modifiers,0,table.unpack(final_normal_keys))\n    end\nend\n-- return true to capture the input, prevent default handling\n-- cnt: pressing normal keys\' count\nfunction key_input(modifiers,cnt,k1,k2,k3,k4,k5,k6)    \n    local key_arr={k1,k2,k3,k4,k5,k6};\n    pressed_capslock=false;\n    key_input_underlying(modifiers,cnt,key_arr);\n    previous_cnt=cnt;\n    previous_key_map_mode=key_map_mode;\n    previous_capslock=pressed_capslock;\n    return true;\nend\n\nfunction main()\n    local ahk_file=read_file("config/config.txt"); \n    ahk_file=nil;  \n    collectgarbage();  \nend\n'},aJJW:function(e,t){},nHjd:function(e,t){},quV6:function(e,t){},s7If:function(e,t){},sJI9:function(e,t){},tERj:function(e,t){},tvR6:function(e,t){},vhHo:function(e,t){e.exports={modes:[{isBasic:!0,macro:!0,map:[["Escape","1","2","3","4","5","6","7","8","9","0","-","=","Backspace"],["Tab","Q","W","E","R","T","Y","U","I","O","P","[","]","\\"],["CapsLock","A","S","D","F","G","H","J","K","L",";","'","Enter"],["ShiftLeft","Z","X","C","V","B","N","M",",",".","/","ShiftRight"],["ControlLeft","MetaLeft","ArrowUp","AltLeft","Space","Space","ControlRight","customized1","customized2","mode1","mode2"]]},{macro:!0,map:[[null,"F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12",null],[null,"BrightDown","BrightUp",null,null,null,null,null,null,null,null,"VolumeDown","VolumeUp","Mute"],[null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null]],trigger:"pressing"},{macro:!1,map:[[null,null,null,null,null,null,null,null,null,null,null,null,null,"Delete"],[null,null,null,null,null,null,null,null,"ArrowUp",null,null,null,null,"PrintScreen"],[null,null,null,null,null,null,null,"ArrowLeft","ArrowDown","ArrowRight",null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null]],trigger:"toggle"}],macro:[{modifiers:["ShiftLeft"],key:"6",expression:"694421865"},{modifiers:["Alt","ShiftLeft"],key:"A",expression:"blackmiaool"},{modifiers:["ControlRight"],key:"W",expression:"{Escape}"},{modifiers:["ControlRight"],key:"N",expression:"{ArrowDown}"},{modifiers:["ControlRight"],key:"P",expression:"{ArrowUp}"},{modifiers:["ControlRight"],key:"F",expression:"{ArrowRight}"},{modifiers:["ControlRight"],key:"B",expression:"{ArrowLeft}"},{modifiers:["ControlRight"],key:"A",expression:"{Home}"},{modifiers:["ControlRight"],key:"E",expression:"{End}"},{modifiers:["ControlRight"],key:"D",expression:"{Delete}"},{modifiers:["ControlRight"],key:"V",expression:"{PageDown}"},{modifiers:["AltLeft"],key:"V",expression:"{PageUp}"},{modifiers:["Control","Alt"],key:"P",expression:"{PrintScreen}"},{modifiers:["ShiftLeft"],key:"P",expression:"git{Space}pull{Space}--rebase"},{modifiers:["ShiftLeft"],key:"F",expression:"function"},{modifiers:["ShiftLeft"],key:"L",expression:"local{Space}"},{modifiers:["ShiftLeft"],key:"R",expression:"return{Space}"},{modifiers:["ShiftRight"],key:"Q",expression:"~"},{modifiers:["ShiftRight"],key:"W",expression:"`"},{modifiers:["ShiftLeft"],key:"I",expression:"@xiaomi.com"},{modifiers:["ShiftLeft"],key:"B",expression:"blackmiaool"},{modifiers:["ShiftLeft"],key:"C",expression:"console.log(){ArrowLeft}"},{modifiers:["ShiftLeft"],key:"V",expression:"console.warn(){ArrowLeft}"},{modifiers:["ShiftLeft"],key:"T",expression:"this.state."},{modifiers:["ShiftLeft"],key:"W",expression:"ilwt.science"},{modifiers:["ShiftLeft"],key:"O",expression:"const{Space}"},{modifiers:["ShiftLeft"],key:"U",expression:"sudo{Space}apt-get{Space}install"},{modifiers:["ShiftLeft"],key:"N",expression:"(()=>{leftbracket}{rightbracket});{ArrowLeft}{ArrowLeft}{ArrowLeft}{Enter}"},{modifiers:[],key:"customized1",expression:"{<^-down}{ArrowLeft}"},{modifiers:[],key:"customized2",expression:"{<^-down}{ArrowRight}"}]}},wNog:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.a5bac256702b46e8ca40.js.map